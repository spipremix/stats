<!--[if IE]>[<script type="text/javascript" src="(#CHEMIN{javascript/excanvas.js})"></script>]<![endif]-->
[<script type="text/javascript" src="(#CHEMIN{javascript/jquery.flot.js})"></script>]
[<script type="text/javascript" src="(#CHEMIN{javascript/jquery.flot.selection.js})"></script>]
[<script type="text/javascript" src="(#CHEMIN{javascript/jquery.tflot.js})"></script>]

<script type="text/javascript">
function trace_stats(){
	// copier le titre des tableaux
	titre = $("#visites_quotidiennes caption").text();
	$("#visites_quotidiennes")
		.before("<h3 class='caption'>" + titre + "</h3>")
		.wrap("<div class='statistiques_visites_quotidiennes statistiques_visites'></div>");

	titre = $("#visites_mensuelles caption").text();
	$("#visites_mensuelles")
		.before("<h3 class='caption'>" + titre + "</h3>")
		.wrap("<div class='statistiques_visites_mensuelles statistiques_visites'></div>");

	// mettre les visites avec un fond colore pour le graphique
	$("#visites_mensuelles thead th:eq(1), #visites_quotidiennes thead th:eq(1)").addClass('flotFill').addClass('flotBar');
	$("#visites_mensuelles thead th:eq(2), #visites_quotidiennes thead th:eq(2)").addClass('flotLine');

	params = {
		legendeExterne:true,
		legendeActions:true,
		width:($('.large #page').length)?'795px':'600px',
		height:'250px',
		modeDate:true,
		zoom:true,
		parse:{
			axeOnTitle:true,
			defaultSerie:{
				bars:{show:true},
				lines:{show:true},
				points:{show:false}
			}
		},
		flot:{
			xaxis:{
				labelWidth:30,
				monthNames: [
					'[(#VAL{2000-01-01}|nom_mois)]',
					'[(#VAL{2000-02-01}|nom_mois)]',
					'[(#VAL{2000-03-01}|nom_mois)]',
					'[(#VAL{2000-04-01}|nom_mois)]',
					'[(#VAL{2000-05-01}|nom_mois)]',
					'[(#VAL{2000-06-01}|nom_mois)]',
					'[(#VAL{2000-07-01}|nom_mois)]',
					'[(#VAL{2000-08-01}|nom_mois)]',
					'[(#VAL{2000-09-01}|nom_mois)]',
					'[(#VAL{2000-10-01}|nom_mois)]',
					'[(#VAL{2000-11-01}|nom_mois)]',
					'[(#VAL{2000-12-01}|nom_mois)]'
				]
			}
		},
		infobulle:{show:true}
	}

	$("#visites_quotidiennes").tFlot(
		$.extend(true, {}, params, {
			grille:{weekend:true},
			flot:{
				xaxis:{
					minTickSize: [1, "day"]
				},
				bars:{barWidth:24 * 60 * 60 * 1000}
			}
		})
	);

	$("#visites_mensuelles").tFlot(
		$.extend(true, {}, params, {
			grille:{years:true},
			flot:{
				xaxis:{
					timeformat:"%b %y",
					minTickSize: [1, "month"]
				},
				bars:{barWidth:30 * 24 * 60 * 60 * 1000 /* nb de jours... approximatif */}
			}
		})
	);
}
(function($){
	$(document).ready(function(){
		trace_stats();
		onAjaxLoad(trace_stats);
	});
})(jQuery);
</script>
